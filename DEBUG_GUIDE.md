# DDC4000 Browser - URL Debug Guide

## üîç **Debug Information Added**

Both web prototype and Flutter app now have comprehensive URL debugging to help troubleshoot connection issues.

---

## üåê **Web Prototype Debugging**

### **Location**: `C:\Coding\DDC4000-Browser\index.html`

### **Debug Features Added:**
1. **Console Logging** - Detailed URL information in browser console
2. **UI Display** - URL shown in status area during connection
3. **Parameter Breakdown** - All URL components logged separately

### **How to Debug Web Version:**
1. Open `C:\Coding\DDC4000-Browser\index.html` in your browser
2. **Open Developer Tools** (F12 or right-click ‚Üí Inspect)
3. Go to **Console** tab
4. Enter DDC4000 settings (IP, protocol, resolution)
5. Click **"Load DDC Interface"**
6. **Check Console Output** for detailed URL debug info:

```
üîó DDC4000 URL DEBUG:
Original URL: http://192.168.10.21/ddcdialog.html?useOvl=1&busyReload=1&type=WVGA
Final URL with timestamp: http://192.168.10.21/ddcdialog.html?useOvl=1&busyReload=1&type=WVGA&_t=1691234567890
Protocol: http
IP: 192.168.10.21
Resolution: WVGA
Proxied: false
Mixed Content: false
```

### **URL Status Display:**
- The status area now shows the exact URL being used
- Format: `Connecting to: http://192.168.10.21/ddcdialog.html?...`

---

## üì± **Flutter App Debugging**

### **Location**: Updated app with debug features

### **Debug Features Added:**
1. **Console Logging** - Comprehensive URL debugging in Flutter logs
2. **Toast Messages** - URL shown in app toast notifications
3. **WebView Events** - All navigation events logged
4. **Error Details** - Detailed error information

### **How to Debug Flutter Version:**

#### **Method 1: ADB Logcat (Recommended)**
```bash
# Connect device and start logging
adb devices
adb -s [DEVICE_ID] logcat | grep -E "(üîó|üåê|‚úÖ|‚ùå|üîÑ)"

# Or filter for Flutter logs
adb -s [DEVICE_ID] logcat | grep flutter
```

#### **Method 2: Android Studio**
1. Open Android Studio
2. Connect device
3. Go to **View** ‚Üí **Tool Windows** ‚Üí **Logcat**
4. Filter by app name: `dev.rappo.ddc4000.ddc4000_browser_app`

#### **Method 3: In-App Debugging**
1. Install the debug APK
2. Open DDC4000 Browser app
3. **Watch for toast messages** showing the URL
4. Check **status bar** for connection details

### **Debug Output Example:**
```
üîó DDC4000 FLUTTER URL DEBUG:
========================================
Protocol: http
IP Address: 192.168.10.21
Resolution: WVGA
Full URL: http://192.168.10.21/ddcdialog.html?useOvl=1&busyReload=1&type=WVGA
URL Components:
  - Base: http://192.168.10.21
  - Path: /ddcdialog.html
  - Parameters: useOvl=1&busyReload=1&type=WVGA
========================================
üåê WebView Page Started: http://192.168.10.21/ddcdialog.html?useOvl=1&busyReload=1&type=WVGA
‚úÖ WebView Page Finished: http://192.168.10.21/ddcdialog.html?useOvl=1&busyReload=1&type=WVGA
```

---

## üîÑ **URL Comparison**

Both versions generate **identical URLs**:

### **QVGA Resolution (320√ó240):**
```
http://IP/ddcdialog.html?useOvl=1&busyReload=1&type=QVGA&x=0&y=0&fit=1
```

### **WVGA Resolution (800√ó480):**
```
http://IP/ddcdialog.html?useOvl=1&busyReload=1&type=WVGA
```

### **Parameters Explained:**
- `useOvl=1` - Enable overlay mode
- `busyReload=1` - Enable busy state reload
- `type=RESOLUTION` - Set DDC4000 display resolution
- `x=0&y=0&fit=1` - QVGA positioning and fit parameters

---

## üìã **Installation & Testing**

### **Install Debug Version:**
```bash
# Check connected devices
adb devices

# Install debug APK
cd "C:\Coding\ddc4000_browser_app"
adb -s [DEVICE_ID] install -r "build/app/outputs/flutter-apk/app-debug.apk"

# Start logging
adb -s [DEVICE_ID] logcat | grep -E "(üîó|üåê|‚úÖ|‚ùå)"
```

### **Test Procedure:**
1. **Install debug app** on Android device
2. **Start logcat monitoring** 
3. **Open web prototype** in browser with DevTools
4. **Configure same DDC4000 settings** in both:
   - Same IP address
   - Same protocol (HTTP/HTTPS)
   - Same resolution (QVGA/WVGA)
5. **Compare URLs** generated by both versions
6. **Test connections** and compare results

---

## üêõ **Troubleshooting**

### **Common Issues:**
1. **URLs match but connection fails** ‚Üí DDC4000 device issue
2. **Different URLs generated** ‚Üí Settings mismatch between versions
3. **No debug output** ‚Üí Logging not started or filtered incorrectly
4. **Toast not showing** ‚Üí App permissions or display issue

### **Debug Checklist:**
- [ ] URLs are identical between web and mobile
- [ ] IP address is reachable from device
- [ ] Protocol matches DDC4000 configuration
- [ ] Resolution setting is correct
- [ ] No network restrictions (firewall, proxy)

---

## üìû **Support**

If URLs match but connections still fail:
1. **Check network connectivity** between device and DDC4000
2. **Verify DDC4000 web interface** works in regular browser
3. **Test both HTTP and HTTPS** protocols
4. **Check firewall settings** on network

---

*Debug features added: August 2025*  
*Version: 1.4.0+debug*